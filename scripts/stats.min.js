ws.onopen=function(){ws.send(JSON.stringify({method:"request",type:"players",qual:"qb"}))},ws.onmessage=(e=>{const r=JSON.parse(e.data);if("requested"==r.method){players[r.qual.toLowerCase()]=r.data;var t=["qb","rb","wr","te","de","lb","cb","s","k","p","off","def"];for(let e=0;e<t.length;e++)if(r.qual.toLowerCase()==t[e]){goToPageStyle(e),render(e);break}}});var currentPage=0,players=[],period=-1;function goToPage(e){var r=["qb","rb","wr","te","de","lb","cb","s","k","p","off","def"][e];if(players[r])goToPageStyle(e),render(e);else{let e={method:"request",type:"players",qual:r};ws.send(JSON.stringify(e))}}function goToPageStyle(e){currentPage=e;var r=document.getElementsByClassName("statPage");for(let e of r)e.style.display="none";r[e].style.display="block";var t=document.getElementsByClassName("posSel");for(let e of t)e.classList.remove("selected");t[e].classList.add("selected");var s=Number(document.getElementsByClassName("statTable")[e].getAttribute("data-period"))+1;document.getElementById("termSel").selectedIndex=s,period=s-1}function render(e){var r=["qb","rb","wr","te","de","lb","cb","s","k","p","off","def"],t=players[r[e]],s=document.getElementsByClassName("statTable")[e];for(s.setAttribute("data-period",period);s.children[0].childNodes.length>2;)s.children[0].lastChild.remove();for(let r of t){let t;t=e<10?JSON.parse(r.stats):10==e?JSON.parse(r.offStats):JSON.parse(r.defStats);for(let e in t)if(-1!=period)t[e][period]?r[`${e}Per`]=t[e][period]:r[`${e}Per`]=0;else{let s=0;for(let r of t[e])s+=r;r[`${e}Per`]=s}}for(let s of t)"qb"==r[e]?s.sort=calcQBRating(s.compPer,s.attPer,s.ydsPer,s.tdPer,s.intPer):"rb"==r[e]||"wr"==r[e]||"te"==r[e]?s.sort=s.ydsPer:"de"==r[e]||"lb"==r[e]?s.sort=s.sackPer:"cb"==r[e]||"s"==r[e]?s.sort=s.intPer:"k"==r[e]?s.sort=s.ptsPer:"p"==r[e]?0==s.puntsPer?s.sort="0.0":s.sort=Number((s.ydsPer/s.puntsPer).toFixed(1)):s.sort="off"==r[e]?calcOffRating(s.playsPer,s.tdPer,s.ptsPer,s.ydsPer):calcDefRating(s.playsDefPer,s.sacksPer,s.intPer,s.tdGivenPer,s.ydsGivenPer,s.ptsGivenPer);t.sort(compare);for(let d of t){var a=[],o=s.insertRow();"qb"==r[e]?(a[0]=`${d.compPer}/${d.attPer}`,a[1]=d.ydsPer,a[2]=`${d.tdPer}/${d.intPer}`,a[3]=calcQBRating(d.compPer,d.attPer,d.ydsPer,d.tdPer,d.intPer)):"rb"==r[e]?(a[0]=d.ydsPer,a[1]=d.attPer,0==d.attPer?a[2]="0.0":a[2]=(Number(d.ydsPer)/Number(d.attPer)).toFixed(1),a[3]=d.tdPer):"wr"==r[e]||"te"==r[e]?(a[0]=d.ydsPer,a[1]=d.recepsPer,0==d.recepsPer?a[2]="0.0":a[2]=(Number(d.ydsPer)/Number(d.recepsPer)).toFixed(1),a[3]=d.tdPer):"de"==r[e]||"lb"==r[e]?(a[0]=d.tacklesPer,a[1]=d.sackPer,a[2]=d.tAttPer,a[3]=d.blitzPer):"cb"==r[e]||"s"==r[e]?(a[0]=d.tacklesPer,a[1]=d.intPer,a[2]=d.tAttPer,a[3]=d.targetsPer):"k"==r[e]?(a[0]=`${d.under40Per}/${d.under40AttPer}`,a[1]=`${d.over40Per}/${d.over40AttPer}`,a[2]=`${d.patPer}/${d.patAttPer}`,a[3]=d.ptsPer):"p"==r[e]?(0==d.puntsPer?(a[0]="0.0",a[1]="0.0"):(a[0]=(d.ydsPer/d.puntsPer).toFixed(1),a[1]=(d.netPer/d.puntsPer).toFixed(1)),a[2]=d.in20Per,a[3]=d.blockedPer):"off"==r[e]?(a[0]=d.playsPer,a[1]=d.firstPer,a[2]=d.ydsPer,a[3]=calcOffRating(d.playsPer,d.tdPer,d.ptsPer,d.ydsPer)):(a[0]=d.sacksPer,a[1]=d.intPer,a[2]=d.ydsGivenPer,a[3]=calcDefRating(d.playsDefPer,d.sacksPer,d.intPer,d.tdGivenPer,d.ydsGivenPer,d.ptsGivenPer));var l=o.insertCell(),n=buildElem("IMG","teamLogo",void 0,l);e<10&&(d.mascot=d.teamMascot),n.src=`logos/${cleanObj(d)}.png`;var P=o.insertCell();P.innerHTML=e<10?`${d.fName} ${d.lName} <span class="num">#${d.id}</span>`:`${d.fName} ${d.lName}`;for(let e of a){o.insertCell().textContent=e}}}function changeTerm(){period=Number(document.getElementById("termSel").value),render(currentPage)}function compare(e,r){return Number(e.sort)!=Number(r.sort)?Number(r.sort)-Number(e.sort):e.lName>r.lName?1:e.lName<r.lName?-1:e.fName>r.fName?1:-1}
